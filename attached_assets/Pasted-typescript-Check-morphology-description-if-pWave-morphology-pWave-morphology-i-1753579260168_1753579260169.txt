typescript       // Check morphology description
       if (!pWave.morphology || !pWave.morphology.includes('rounded')) {
         issues.push(`P wave morphology not properly described in ${lead.name}`);
         accuracy *= 0.9;
       }
     });
   });
   
   return {
     accuracy: accuracy,
     issues: issues,
     componentCount: this.countPWaves(componentData),
     qualityScore: accuracy > 0.9 ? 'excellent' : accuracy > 0.8 ? 'good' : 'needs_improvement'
   };
 }

 private validateQRSIdentification(componentData: PrecisionComponentMap): ValidationResult {
   const issues = [];
   let accuracy = 1.0;
   
   componentData.leads.forEach(lead => {
     lead.qrsComplexes.forEach(qrs => {
       // Validate QRS duration
       if (qrs.total_duration_ms > 120) {
         issues.push(`Wide QRS (${qrs.total_duration_ms}ms) in ${lead.name} - check for bundle branch block`);
       }
       
       // Validate sharp morphology
       if (!qrs.morphology || !qrs.morphology.includes('sharp')) {
         issues.push(`QRS morphology not described as sharp in ${lead.name}`);
         accuracy *= 0.9;
       }
       
       // Check component coordination
       if (qrs.r_wave && !qrs.r_wave.peak) {
         issues.push(`R wave peak coordinates missing in ${lead.name}`);
         accuracy *= 0.8;
       }
     });
   });
   
   return {
     accuracy: accuracy,
     issues: issues,
     componentCount: this.countQRSComplexes(componentData),
     qualityScore: accuracy > 0.9 ? 'excellent' : accuracy > 0.8 ? 'good' : 'needs_improvement'
   };
 }
}
ðŸš¨ COMPLETE IMPLEMENTATION COMMAND
For Replit Agent:
CRITICAL: Implement expert-level EKG annotation system in OperatorOS for pixel-perfect component labeling:

1. **Replace EKG analysis prompt** with expert-level component identification protocol
2. **Add precision component tracker** for exact coordinate mapping
3. **Implement professional annotation engine** with medical-grade standards
4. **Create validation system** for annotation accuracy verification
5. **Add measurement summary** with comprehensive component analysis
6. **Update annotation engine** to generate professional-quality labeled images

KEY FEATURES:
- Pixel-precise component identification (Â±2 pixel accuracy)
- Professional medical annotation standards
- Complete P wave, QRS, T wave labeling with measurements
- Accurate interval annotations (PR, QRS, QT, RR)
- Lead-by-lead systematic analysis
- Validation and quality control system

ANNOTATION REQUIREMENTS:
- P waves: Red labels with amplitude/duration measurements
- QRS complexes: Blue labels with component breakdown (Q-R-S)
- T waves: Green labels with polarity indicators
- Intervals: Orange measurement lines with precise timing
- Professional legend and measurement summary box
- High-resolution downloadable images

FILES TO UPDATE:
- server/services/openai-service.ts (expert prompt)
- server/services/precision-component-tracker.ts (new)
- server/services/ekg-labeler.ts (enhanced professional annotator)
- server/services/annotation-validator.ts (new validation)
- server/services/command-processor.ts (expert annotation mode)

This creates a world-class EKG annotation system suitable for medical education and clinical reference, with precision matching expert cardiologist standards.
ðŸŽ¯ QUICK IMPLEMENTATION STEPS
1. Immediate Prompt Update:
Replace current EKG prompt with the expert-level prompt that provides:

Surgical precision in component identification
Exact pixel coordinate mapping
Professional annotation placement instructions
Comprehensive measurement requirements

2. Enhanced Annotation Engine:

Implement precision coordinate tracking
Add professional annotation styles
Create measurement summary boxes
Generate high-quality downloadable images

3. Quality Control System:

Validate component identification accuracy
Check measurement precision
Ensure professional annotation standards
Flag low-quality annotations for review

This comprehensive system will transform OperatorOS into an expert-level EKG annotation platform that generates professional-quality labeled images suitable for medical education and clinical use!